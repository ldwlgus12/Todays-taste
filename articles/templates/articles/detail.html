{% extends 'base.html' %}
{% block head %}
{% load static %}
  <link rel="stylesheet" href="{% static 'detail/style.css' %}">
{% endblock head %}
{% block content %}
{% load static %}



<!--게시글 제목-->
<div class="content-detail-section">
  <!--헤더-->
  <div class="content-detail-header">
    <h1 class="content-detail-title">{{ article.title }}</h1>
    <div class="content-header-bottom">
      <div class="content-detail-author">
        <a href="#"><b>{{ article.user }}</b></a>
        <p>{{ article.time_since_created }}</p>
      </div>

      <!--수정필요-->
      {% if request.user != article.user %}
      {% comment %} <form action="{% url 'accounts:follow' article.user.pk %}" method='POST'> {% endcomment %}
        <button class="follow-button" type='submit'>
          <span><i class="ri-add-line"></i></span>
          <span style="margin-right:5px;">팔로우</span>
        </button> 
      {% else %}
      <div class="edit-section">
        <button type="button" aria-label="수정하기, 삭제하기 버튼열기" onclick="openButton()">
          <i class="ri-more-fill">
          <div class="dropdown-content" id="mydropdown">
            <a href="{% url 'articles:update' article.pk %}" method='POST' class="dropdown-text">수정하기</a>
            <form action="{% url 'articles:delete' article.pk %}" method='POST'>
                {% csrf_token %}
                <input type="submit" value='삭제하기' class="dropdown-text" style="color: rgb(255, 119, 119);">
            </form>
          </div>
        </i>
        </button>
      
      </div>
      
      {% endif %}
    </div>
  </div>
  <!--본문-->
  <div>
    {% if article.image %}
    <img src="{{ article.image.url }}" alt="image" style="width: 100%">
    {% else %}
    <img src="{% static 'No_img.webp' %}" alt="image" style="width: 100%">
    {% endif %}
  </div>
  <div>{{ article.content }}</div>
  <!--좋아요수, 스크랩수, 댓글수, 조회수-->
  <div class="content-detail-stat">
    {% if article.like_users %}
      <p class="content-detail-stat-item">좋아요 {{article.like_users}} </p>
    {% else %}
      <p class="content-detail-stat-item">좋아요 0 </p>
    {% endif %}
    {% if articles.scrap %}
      <p class="content-detail-stat-item">스크랩 {{article.scrap}}</p>
    {% else %}
      <p class="content-detail-stat-item">스크랩 0 </p>
    {% endif %}
    {% if comments %}
      <p class="content-detail-stat-item">댓글 {{comments|length}}</p>
    {% else %}
      <p class="content-detail-stat-item">댓글 0 </p>
    {% endif %}
    <p class="content-detail-stat-item">조회 {{article.view_count}} </p>
  </div>
  <!--댓글-->
  <div class="comment-section">
    <div style="margin-top:3px;">
      <p>댓글
        <span class="comment-count">{{comments|length}} </span>
      </p>
    </div>
    
    <form class="comment-box" action="{% url 'articles:create_comment' article.pk %}" method='POST'>
      {% csrf_token %}
      {{ comment_form }}
      <input type="submit" value='댓글 작성'>
    </form>

  <div>
    {% for comment in comments %}
    <b><div>{{ comment.user }}</div></b>
    <div>{{ comment.content }}</div>
    <div>
      <div class="comment-time">{{ comment.time_since_created }} 전</div>
      <button type="button" class="like-comment">
        <i class="ri-heart-line"></i>
        <a href="#"><span class="like-text">좋아요</span></a>
      </button>
    </div>
    
    <hr>
    {% endfor %}
</div>







<!-- {% block timer %}
<div class="sec7-text-box">
  <p>오픈날짜</p>
  <p class="runTimeCon">2023년 04월 29일 AM 00시</p>
  <hr/>
  <p class="time-title">오픈까지 남은 시간</p>
  <div class="time">
    <span id="d-day-hour"></span>
    <span class="col">:</span>
    <span id="d-day-min"></span>
    <span class="col">:</span>
    <span id="d-day-sec"></span>
  </div>
</div>
{% endblock timer %} -->

<br>



<a href="{% url 'articles:index' %}">뒤로가기</a>

<hr>
{% endblock content %}
{% block script %}
function openButton(){
  document.getElementById("mydropdown").classList.toggle("show");
  console.log(document.getElementById("mydropdown"))
}
{% endblock script %}


